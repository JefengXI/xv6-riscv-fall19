# util lab

## 该分支内实现了MIT-6.s081-OS sh util的实验具体代码文件位于user文件夹下的nsh.c

## 实验注意点如下:

#### nsh要求实现两元素管道、输入输出重定向、执行常见的带参数命令。

#### 主要分为3个部分实现：命令读取、命令分析、命令执行。

#### 首先便是关于命令读取，具体函数为getcmd，该函数参考sh.c自带函数编写，将命令行的输入按行读入。

#### 命令分析分为读取到的未处理过命令buf，处理后的命令参数argv[]和命令参数个数argc三个部分。由于命令是按行读取的，显然命令分析也是按行进行。具体操作为读取命令中的首个非空字符，一直读取至再次遇到空字符即为一个参数，重复此流程直到遇见的换行符或超过最大参数数量为止。

#### 命令执行主要考虑重定向和管道这两个特例。

#### 对于管道，我们先查看当前argv中是否含'|'，若含有则将命令参数分为左右两个部分执行。

#### 对于重定向，我们遍历argv查看是否含有'<' 或 '>'，若含有则先重定向输入输出，再执行整个指令。

#### 执行指令时注意exec()函数要求argv最后一个值为0即'\0'。